{% load mytemplatetags %}



<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>MSQCdb - ChartView - Instrument TOSET</title>

		<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery-1.8.2.min.js"></script>
		<script type="text/javascript">
$(function() {
	$.getJSON('{{ chart_data_link }}&callback=?', function(data) {
		
		Highcharts.setOptions({
    		global: {
        		useUTC: true
    		}
		});

		
		// Create the chart
		window.chart = new Highcharts.StockChart({
		    chart: {
		        renderTo: 'container',
		        zoomType: 'x'
		    },
			credits: {
                enabled: false
            },
		    rangeSelector: {
		        selected: 1
		    },

		    title: {
		        text: 'Instrument Chart to SET'
		    },
            xAxis: {
                type: 'datetime',
                ordinal: false,

            },
		    yAxis: {
		        title: {
		            text: 'to SET'
		        }
		    },

			series: [{
		        name: 'to SET',
		        data: data,
		        marker : {
					enabled : true,
					radius : 3
				},
				id: 'dataseries',
				tooltip: {
					valueDecimals: 2
				}
		    }, 
		    {% for event in events %}
		    {
				type : 'flags',
				data : [{
					
					x : new Date({{event.datetime|epoch}}),
					title : '{{ event.event_type|slice:"1" }}',
					text : '{{ event.event_type }}: "{{ event.name }}"'
				}],
				{% if event.event_type|slice:"1" == 'F' %}
				shape : 'squarepin',
            			color : '#AA4643',
            	{% else %}
            		{% if event.event_type|slice:"1" == 'C' %}
            			shape : 'circlepin',
            			color : '#006000',
            		{% else %}
            			shape : 'circlepin',
            			color : '#8b8989',
            		{% endif %}
            	{% endif %}
				width : 16,
				events: {
        			click: function(event) {
        				location.href='/admin/MSQCdb_app/eventlog/{{ event.pk }}/';
        			}
        		}
			},
		    {% endfor %}
		    ]
		});
	});
});
		</script>
	</head>
	<body>
<script src="{{ MEDIA_URL }}js/Highstock-1.2.2/js/highstock.js"></script>
<script src="{{ MEDIA_URL }}js/Highstock-1.2.2/js/modules/exporting.js"></script>

<div id="container" style="height: 500px; min-width: 500px"></div>
	</body>
</html>
